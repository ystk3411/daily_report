## 取り組んだ課題一覧
* 米国AI開発者がゼロから教えるDocker講座
## 分かったこと
Docker
* ```FROM```
  * 業務で使う際はイメージが大きくなってしまうので最初に指定するイメージはなるべく最小のサイズのものにした方がいい。
* ```RUN```
  * ```touch```で新たにファイルを作成したりベースのイメージを好きなようにカスタマイズできる。
  * ```RUN```する度にベースのイメージにレイヤーが追加される。
  * ```RUN```をしすぎるとイメージが大きくなり過ぎてしまうので注意しなければならない。
  * レイヤーを最小にするために
    * レイヤーを作るのは```RUN```、```COPY```、```ADD```であることを認識しておく必要がある。
    * 実務では最初にすることはパッケージをインストールすること。```apt-get update```と```apt-get install```を使う。
      * ```apt-get update```で最新のパッケージリストを取得して古いバージョンを持ってこないようにする。インストールの前にしておきたい。
      * ```apt-get install　パッケージ名```でパッケージをインストールする。パッケージ名は複数入力できるので余分な```RUN```コマンドを省ける。“パッケージが多くなると見辛くなるので\で改行して見やすくした方が良い。
    * パッケージは複数必要になりインストールのたびに```RUN```をするのを防ぐために```&&```でコマンドを繋げて1行の```RUN```で収める。```apt-get update && apt-get install　パッケージ名```で1行でアップデートとインストールができる。
    * キャッシュ
      * キャッシュはレイヤーごとに保存されるので後からdockerファイルに追加があった時に```RUN```を複数行に分けることも必要。これをしないとインストールするパッケージが増えてきたときに時間がかかり過ぎてしまう。
      * ```apt-get install```に```-y```をオプションとしてつけることで途中のインストールするかという質問にイエスで自動的に回答してくれる。
      * 最終的には```RUN```を1行にまとめてアップデートとインストールをする形にする。
* ```CMD```
  * コンテナのデフォルトのコマンドを指定。ubuntuのイメージのbashがデフォルトコマンド。
  * dockerファイルの最後に記載する。ファイル一つにつきCMDは一つ。
  * ```CMD ["コマンド","引数"]```のような形で記載。特にしたいことがなければ/bin/bashを指定する。
* CMDとRUNの違い
  * RUNはレイヤーをつくりCMDはレイヤーを作らない。
  * パッケージの追加など変更を保存したい内容はRUNを使用する。
* ```docker build```
  * build contextをdocker daemonに送ってイメージを作成したりビルドしたりする。
* build context
  * ビルドした際のディレクトリのことを指す。
  * 無関係なファイルはオーバーヘッドの可能性があるのでdocker context内に入れない。
* ```COPY```
  * build context内のファイルやフォルドをコンテナに渡すことができる。
  * ```COPY ファイル名 コピー先のディレクトリのパス```で実行。
*  ADDとCOPYの違い
  * ADDは圧縮したtarファイルなどを受け渡す時に使う。受け渡した後に受け渡し先で解凍までやってくれる。
* docker contextにDockerfileがなかったら
  * ビルドするときはDockerfileという名前のファイルを探すが、build context内に入ってない場合は```docker build -f dockerfilename buildcontext```で指定したdockerファイルをビルドする。
  * dockerファイルはテスト用や開発用など複数用意するケースがあり```docker.dev```で開発用、```docker.test```でテスト用のように使い分ける。
* ```ENTRYPOINT```
  * ディレクションの一つで```ENTRYPOINT ["コマンド"]```のように使う。
  * 設定したコマンドをrunした時に絶対使うという意味。なので```CMD```での上書きは不可。runの時に他のコマンドも指定不可。
  * ```ENTRYPOINT```を使った時のCMDの役割は```ENTRYPOINT```で指定したコマンドに対するオプションを```CMD ["オプション"]```のように設定する。
* ENV
  * ディレクションの一つで作成したコンテナに環境変数を設定できる。
  * 以下のような書き方で環境変数に値を設定できる。
     ```
     ENV key1 value
     ENV key2=value
     ENV key3="value" key4=v\ a\ l\ u\ e
     ```
* ```WORKDIR```
  * ```RUN```コマンドで実行されたコマンドはすべてルートディレクトリで実行される。そのディレクトリを変更するコマンド。
  * ```WORKDIR パス```で実行。パスにはそれ以降のディレクションがどこで行われるかを追いやすくするために絶対パスで記載するのがベター。   


## 次やること
*  米国AI開発者がゼロから教えるDocker講座の続き
## 感じたこと
*  エントリーポイントがややこしかった。
 
## 学習時間
今日：6.0h
合計：141.5h
